
@model IEnumerable<Department>
@{
    ViewData["Title"] = "ألأقسام";
}

<div class="row mb-1" >
    <div class="col-md-4">
        <a class="btn btn-primary" asp-action="create" asp-area="" asp-controller="Department">
            إضافة قسم جديد
        </a>
    </div>
</div>

<div class="card">
  <div class="table-responsive">
    <table class="table align-items-center mb-0">
      <thead>
        <tr>
          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">اسم القسم</th>
          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">تاريخ انشاء القسم</th>
          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2"></th>
         
        </tr>
      </thead>
      <tbody>
                @foreach(var record in Model)
                {
                    <tr>
                      <td>
                        <div class="d-flex px-2">
                          <div class="my-auto">
                            <h6 class="mb-0 text-xs">@record.Name</h6>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p dir="rtl" class="text-xs font-weight-normal mb-0">@(record.CreatedAt.ToString("dd-MMM-yyyy", new CultureInfo("ar-AE")))</p>
                      </td>
                      <td class="align-middle">
                          <a class="text-secondary font-weight-bold text-xs" asp-area="" asp-action="details" asp-controller="Department" asp-route-id="@record.Id">
                            <span class="material-symbols-outlined">
                              <i title="تفاصيل" class="material-icons-round opacity-10">info</i>
                            </span>
                          </a>

                             <a class="text-secondary font-weight-bold text-xs" href="">
                            <span class="material-symbols-outlined">
                              <i title="تفاصيل" style="background:red!important" class="material-icons-round opacity-10" onclick="del(event,@record.Id)">delete</i>
                            </span>
                          </a>
                      </td>
                </tr>

                }
      </tbody>
    </table>
  </div>
  </div>


  @section Scripts{
      <script>
          function del(e, id) {

              Swal.fire({
                  title: 'هل أنت متأكد من المسح؟',
                  showCancelButton: true,
                  confirmButtonText: 'حفظ',
                  cancelButtonText: `إلغاء`,
                }).then((result) => {
                  /* Read more about isConfirmed, isDenied below */
                  if (result.isConfirmed) {
                        e.currentTarget.parentElement.parentElement.remove()
                        $.ajax({
                            url: '/department/delete',
                            data: {
                                id:id
                            },
                            contentType: 'application/json',
                            success: function (data) {
                                console.log(data)
                            },
                            error: function (e) {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'نعتذر بالرجاء حاول مره اخرى',
                                    text: 'حدث خطأ أثناء المسح',
                                })
                            }
                        })
                    }
                    Swal.fire('تتم العمليه!', '', 'success')

                  } else if (result.isCancel) {
                    Swal.fire('لم تكتمل المهمه', '', 'info')
                  }
                })

              
      </script>
  }